<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Typhoon - Dependency Injection with Swift</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="../assets/built/screen.css?v=0661887258">

    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
    <link rel="canonical" href="http://localhost:2368/typhoon-dependency-injection-with-swift/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="http://localhost:2368/typhoon-dependency-injection-with-swift/amp/">
    
    <meta property="og:site_name" content="Coding Ricky">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Typhoon - Dependency Injection with Swift">
    <meta property="og:description" content="Dependency Injection is a useful design pattern that allows for an application to be decoupled and it simplifies testing.  It is used in the Java world with frameworks like Spring and Guice. In Swift one Dependency Injection container is Typhoon. This article will show how to incorporate Typhoon in an">
    <meta property="og:url" content="http://localhost:2368/typhoon-dependency-injection-with-swift/">
    <meta property="article:published_time" content="2015-04-14T04:18:56.000Z">
    <meta property="article:modified_time" content="2015-04-17T09:16:33.000Z">
    <meta property="article:tag" content="Dependency Injection">
    <meta property="article:tag" content="marvel">
    <meta property="article:tag" content="swift">
    <meta property="article:tag" content="typhoon">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Typhoon - Dependency Injection with Swift">
    <meta name="twitter:description" content="Dependency Injection is a useful design pattern that allows for an application to be decoupled and it simplifies testing.  It is used in the Java world with frameworks like Spring and Guice. In Swift one Dependency Injection container is Typhoon. This article will show how to incorporate Typhoon in an">
    <meta name="twitter:url" content="http://localhost:2368/typhoon-dependency-injection-with-swift/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Ricky Yim">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Dependency Injection, marvel, swift, typhoon">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Coding Ricky",
        "logo": "http://localhost:2368/favicon.ico"
    },
    "author": {
        "@type": "Person",
        "name": "Ricky Yim",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/8eddbc37dcb9a518b0a370c977509fde?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "http://localhost:2368/author/ricky/",
        "sameAs": []
    },
    "headline": "Typhoon - Dependency Injection with Swift",
    "url": "http://localhost:2368/typhoon-dependency-injection-with-swift/",
    "datePublished": "2015-04-14T04:18:56.000Z",
    "dateModified": "2015-04-17T09:16:33.000Z",
    "keywords": "Dependency Injection, marvel, swift, typhoon",
    "description": "Dependency Injection is a useful design pattern that allows for an application to be decoupled and it simplifies testing.  It is used in the Java world with frameworks like Spring and Guice. In Swift one Dependency Injection container is Typhoon. This article will show how to incorporate Typhoon in an",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:2368/"
    }
}
    </script>

    <script src="../public/ghost-sdk.js?v=0661887258"></script>
<script>
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "9652dc6d90f3"
});
</script>
    <meta name="generator" content="Ghost 1.22">
    <link rel="alternate" type="application/rss+xml" title="Coding Ricky" href="http://localhost:2368/rss/">

</head>
<body class="post-template tag-dependency-injection tag-marvel tag-swift tag-typhoon">

    <div class="site-wrapper">

        

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
                <a class="site-nav-logo" href="http://localhost:2368">Coding Ricky</a>
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="http://localhost:2368/">Home</a></li>
</ul>

    </div>
    <div class="site-nav-right">
        <div class="social-links">
        </div>
            <a class="rss-button" href="https://feedly.com/i/subscription/feed/http://localhost:2368/rss/" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"></circle><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"></path></svg>
</a>
    </div>
</nav>
    </div>
</header>


<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post tag-dependency-injection tag-marvel tag-swift tag-typhoon no-image">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="2015-04-14">14 April 2015</time>
                        <span class="date-divider">/</span> <a href="../tag/dependency-injection/">Dependency Injection</a>
                </section>
                <h1 class="post-full-title">Typhoon - Dependency Injection with Swift</h1>
            </header>


            <section class="post-full-content">
                <div class="kg-card-markdown"><p>Dependency Injection is a useful design pattern that allows for an application to be decoupled and it simplifies testing.  It is used in the Java world with frameworks like <a href="http://projects.spring.io/spring-framework/">Spring</a> and <a href="https://github.com/google/guice">Guice</a>. In Swift one Dependency Injection container is <a href="http://typhoonframework.org/">Typhoon</a>. This article will show how to incorporate Typhoon in an application.</p>
<p>Let's start with the code from <a href="http://codingricky.com/swiftly-access-marvel-characters/">this article</a>. It is a very simple application that accesses the developer API of <a href="https://developer.marvel.com/">Marvel</a> to download images of a character.</p>
<p><img src="http://localhost:2373/content/images/2015/04/dependency-injection.png" alt=""></p>
<p>The <strong>ViewController</strong> class uses a <strong>MarvelService</strong> which has three properties; public key, private key and url. The <strong>MarvelService</strong> is the class that is responsible for interfacing with the Marvel API. Our first step will be injecting the MarvelService into the ViewController.</p>
<p>To get the sample code running, you will need a few things installed first.</p>
<p><strong>Prerequisites</strong></p>
<ul>
<li>XCode 6.3</li>
<li>Cocoapods</li>
<li>Git</li>
</ul>
<p>1.Checkout the code from <a href="https://github.com/codingricky/marvel-sample">github</a> and use the <strong>typhoon</strong> branch. The dependencies have be defined in <strong>Podfile</strong>.</p>
<p>2.Open the project and look inside the <strong>ViewController</strong> class and the <strong>download</strong> method.</p>
<p>It will look like the following:</p>
<pre><code class="language-swift"> 		var marvelService = MarvelService()
         marvelService.download(name!, completeCallback: {(image: UIImage) in
            dispatch_async(dispatch_get_main_queue()) {
                self.imageView.image = image
            }
        })
        
</code></pre>
<p>3.We will now get Typhoon to dependency inject the <strong>MarvelService</strong> dependency.</p>
<p>Open up the <strong>ViewController</strong> class and create a couple of properties that will be injected.</p>
<pre><code class="language-swift">
class ViewController: UIViewController {

    @IBOutlet weak var imageView: UIImageView!
    var marvelService: MarvelService?
    var name: String?
...
</code></pre>
<p>This is the updated <strong>download</strong> method.</p>
<pre><code class="language-swift">@IBAction func download(sender: AnyObject) {
        marvelService!.download(name!, completeCallback: {(image: UIImage) in
            dispatch_async(dispatch_get_main_queue()) {
                self.imageView.image = image
            }
        })
    }
</code></pre>
<p>4.Let's change the <strong>MarvelService</strong> so that its properties can be dependency injected.</p>
<pre><code class="language-swift">class MarvelService :NSObject {
    var publicKey: String?
    var privateKey: String?
    var url: String?

...

</code></pre>
<p>Also you will need to change the <strong>download</strong> function to deal with the optionals of the properties.</p>
<pre><code class="language-swift">func download(name: String, completeCallback: UIImage -&gt; () ) {
        var request = HTTPTask()
        request.responseSerializer = JSONResponseSerializer()
        let ts = NSDate().timeIntervalSince1970.description
        let hash = "\(ts)\(privateKey!)\(publicKey!)".md5()
        
        request.GET(url!, parameters: ["nameStartsWith": name, "apikey": publicKey!, "ts" : ts, "hash": hash], success: { (response: HTTPResponse) -&gt; Void in
            if (response.responseObject != nil) {
                let character = Character(JSONDecoder(response.responseObject!))
                self.downloadCharacterImage(character, completeCallback: completeCallback)
            }
            },failure: {(error: NSError, response: HTTPResponse?) -&gt; Void in
                println("got an error: \(error)")
        })
    }
</code></pre>
<p>5.Create a <strong>configuration.plist</strong> file that will contain the String properties of the application.</p>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;
&lt;plist version="1.0"&gt;
&lt;dict&gt;
	&lt;key&gt;url&lt;/key&gt;
	&lt;string&gt;http://gateway.marvel.com:80/v1/public/characters&lt;/string&gt;
	&lt;key&gt;api.public.key&lt;/key&gt;
	&lt;string&gt;FILL IN YOUR OWN&lt;/string&gt;
	&lt;key&gt;api.private.key&lt;/key&gt;
	&lt;string&gt;FILL IN YOUR OWN&lt;/string&gt;
    &lt;key&gt;name&lt;/key&gt;
    &lt;string&gt;Ant-Man&lt;/string&gt;
&lt;/dict&gt;
&lt;/plist&gt;
</code></pre>
<p>Make sure you fill in your own public and private keys that you get from the <a href="http://developer.marvel.com">http://developer.marvel.com</a> site.</p>
<p>6.The last piece is defining the Typhoon assembly. This is where the configuration of the dependencies will take place.</p>
<p>We will define 3 dependencies in the assembly the marvel Service, config and viewController. Open up the <strong>MarvelAssembly</strong> class.</p>
<p>The configuration is defined as the follows. This will make the properties available to be injected in the <strong>Configuration.plist</strong>.</p>
<pre><code class="language-swift">        public dynamic func config() -&gt; AnyObject {
            return TyphoonDefinition.configDefinitionWithName("Configuration.plist")
        }
</code></pre>
<p>Let's define the <strong>MarvelService</strong> and its dependencies.</p>
<pre><code class="language-swift">        public dynamic func marvelService() -&gt; AnyObject {
            return TyphoonDefinition.withClass(MarvelService.self) {
                    (definition) in
                        definition.injectProperty("url", with:TyphoonConfig("url"))
                        definition.injectProperty("publicKey", with:TyphoonConfig("api.public.key"))
                        definition.injectProperty("privateKey", with:TyphoonConfig("api.private.key"))
            }
        }
</code></pre>
<p>The last class is the <strong>ViewController</strong>.</p>
<pre><code class="language-swift">
        public dynamic func viewController() -&gt; AnyObject {
            return TyphoonDefinition.withClass(ViewController.self) {
                (definition) in
                    definition.injectProperty("marvelService", with:self.marvelService())
                    definition.injectProperty("name", with:TyphoonConfig("name"))
        
                    definition.scope = TyphoonScope.Singleton
            }
        }
</code></pre>
<p>This article has shown you how to take an dependency and inject its dependencies. This is a much more flexible and testable way of dealing with dependencies.</p>
<p>Here are some references.</p>
<ul>
<li><a href="http://typhoonframework.org/">Typhoon</a></li>
<li><a href="http://en.wikipedia.org/wiki/Dependency_injection">Dependency Injection</a></li>
<li><a href="http://developer.marvel.com">Developer Marvel</a></li>
<li><a href="http://codingricky.com/swiftly-access-marvel-characters/">Swiftly access Marvel characters</a></li>
</ul>
</div>
            </section>


            <footer class="post-full-footer">


                    
<section class="author-card">
        <img class="author-profile-image" src="http://www.gravatar.com/avatar/8eddbc37dcb9a518b0a370c977509fde?s=250&amp;d=mm&amp;r=x" alt="Ricky Yim">
    <section class="author-card-content">
        <h4 class="author-card-name"><a href="../author/ricky/">Ricky Yim</a></h4>
            <p>Read <a href="../author/ricky/">more posts</a> by this author.</p>
    </section>
</section>
<div class="post-full-footer-right">
    <a class="author-card-button" href="../author/ricky/">Read More</a>
</div>


            </footer>


        </article>

    </div>
</main>

<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
                <article class="read-next-card">
                    <header class="read-next-card-header">
                        <small class="read-next-card-header-sitetitle">— Coding Ricky —</small>
                        <h3 class="read-next-card-header-title"><a href="../tag/dependency-injection/">Dependency Injection</a></h3>
                    </header>
                    <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"></path></svg>
</div>
                    <div class="read-next-card-content">
                        <ul>
                            <li><a href="../dependency-injection-with-the-play-framework/">Play-ing with Dependency Injection</a></li>
                            <li><a href="../guicing-up-the-play-framework-dependency-injection-with-guice-and-play/">Guicing up the Play Framework - Dependency Injection with Guice and Play</a></li>
                        </ul>
                    </div>
                    <footer class="read-next-card-footer">
                        <a href="../tag/dependency-injection/">See all 2 posts →</a>
                    </footer>
                </article>

                <article class="post-card post tag-swift tag-ios-2 tag-watchkit tag-apple-watch tag-table no-image">
    <div class="post-card-content">
        <a class="post-card-content-link" href="../watchkit-tables/">
            <header class="post-card-header">
                    <span class="post-card-tags">swift</span>
                <h2 class="post-card-title">Using WatchKit tables</h2>
            </header>
            <section class="post-card-excerpt">
                <p>The release of the Apple Watch has meant a whole host of possiblities for application developers. However writing apps for watches is very different to writing apps for phones. One particular area that</p>
            </section>
        </a>
        <footer class="post-card-meta">

            <ul class="author-list">
                <li class="author-list-item">

                    <div class="author-name-tooltip">
                        Ricky Yim
                    </div>

                        <a href="../author/ricky/" class="static-avatar"><img class="author-profile-image" src="http://www.gravatar.com/avatar/8eddbc37dcb9a518b0a370c977509fde?s=250&amp;d=mm&amp;r=x" alt="Ricky Yim"></a>
                </li>
            </ul>

            <span class="reading-time">2 min read</span>

        </footer>
    </div>
</article>

                <article class="post-card post no-image">
    <div class="post-card-content">
        <a class="post-card-content-link" href="../garmins-connect-iq/">
            <header class="post-card-header">
                <h2 class="post-card-title">Introduction to Garmin's Connect IQ</h2>
            </header>
            <section class="post-card-excerpt">
                <p>Late last year, Garmin announced a development platform for their wearables. This enabled software developers to build applications for Garmin watches. This opens up a whole host of possibilties in how people use</p>
            </section>
        </a>
        <footer class="post-card-meta">

            <ul class="author-list">
                <li class="author-list-item">

                    <div class="author-name-tooltip">
                        Ricky Yim
                    </div>

                        <a href="../author/ricky/" class="static-avatar"><img class="author-profile-image" src="http://www.gravatar.com/avatar/8eddbc37dcb9a518b0a370c977509fde?s=250&amp;d=mm&amp;r=x" alt="Ricky Yim"></a>
                </li>
            </ul>

            <span class="reading-time">2 min read</span>

        </footer>
    </div>
</article>

        </div>
    </div>
</aside>

<div class="floating-header">
    <div class="floating-header-logo">
        <a href="http://localhost:2368">
            <span>Coding Ricky</span>
        </a>
    </div>
    <span class="floating-header-divider">—</span>
    <div class="floating-header-title">Typhoon - Dependency Injection with Swift</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"></path>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=Typhoon%20-%20Dependency%20Injection%20with%20Swift&amp;url=http://localhost:2368/typhoon-dependency-injection-with-swift/" onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"></path></svg>
        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:2368/typhoon-dependency-injection-with-swift/" onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"></path></svg>
        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>




        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="http://localhost:2368">Coding Ricky</a> © 2018</section>
                <nav class="site-footer-nav">
                    <a href="http://localhost:2368">Latest Posts</a>
                    
                    
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>


    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="../assets/js/jquery.fitvids.js?v=0661887258"></script>


    <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();

});
</script>


    

</body>
