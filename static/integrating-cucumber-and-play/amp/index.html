
<head>
    <meta charset="utf-8">

    <title>Integrating Cucumber and Play</title>

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <link rel="shortcut icon" href="../../favicon.ico">

    <link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon">
    <link rel="canonical" href="../index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta property="og:site_name" content="Coding Ricky">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Integrating Cucumber and Play">
    <meta property="og:description" content="The default application generated by Play has examples of unit and integration tests, however it does not demonstrate how to integrate in any Behaviour Driven Development (BDD) frameworks. The value of a BDD framework like Cucumber is extremely high when attempting to achieve strong collaboration between various stakeholders like Developers">
    <meta property="og:url" content="http://localhost:2368/integrating-cucumber-and-play/">
    <meta property="article:published_time" content="2013-10-13T01:00:00.000Z">
    <meta property="article:modified_time" content="2014-01-01T05:03:37.000Z">
    <meta property="article:tag" content="Play!">
    <meta property="article:tag" content="Play">
    <meta property="article:tag" content="Testing">
    <meta property="article:tag" content="Cucumber">
    <meta property="article:tag" content="Behaviour Driven Development">
    <meta property="article:tag" content="BDD">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Integrating Cucumber and Play">
    <meta name="twitter:description" content="The default application generated by Play has examples of unit and integration tests, however it does not demonstrate how to integrate in any Behaviour Driven Development (BDD) frameworks. The value of a BDD framework like Cucumber is extremely high when attempting to achieve strong collaboration between various stakeholders like Developers">
    <meta name="twitter:url" content="http://localhost:2368/integrating-cucumber-and-play/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Ricky Yim">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Play!, Play, Testing, Cucumber, Behaviour Driven Development, BDD">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Coding Ricky",
        "logo": {
            "@type": "ImageObject",
            "url": "http://localhost:2368/favicon.ico",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Ricky Yim",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/8eddbc37dcb9a518b0a370c977509fde?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "http://localhost:2368/author/ricky/",
        "sameAs": []
    },
    "headline": "Integrating Cucumber and Play",
    "url": "http://localhost:2368/integrating-cucumber-and-play/",
    "datePublished": "2013-10-13T01:00:00.000Z",
    "dateModified": "2014-01-01T05:03:37.000Z",
    "keywords": "Play!, Play, Testing, Cucumber, Behaviour Driven Development, BDD",
    "description": "The default application generated by Play has examples of unit and integration tests, however it does not demonstrate how to integrate in any Behaviour Driven Development (BDD) frameworks. The value of a BDD framework like Cucumber is extremely high when attempting to achieve strong collaboration between various stakeholders like Developers",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:2368/"
    }
}
    </script>

    <meta name="generator" content="Ghost 1.22">
    <link rel="alternate" type="application/rss+xml" title="Coding Ricky" href="../../rss/index.html">

    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic%7COpen+Sans:700,600,400">
    <style amp-custom>html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:bold}dfn{font-style:italic}h1{margin:0.67em 0;font-size:2em}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{position:relative;vertical-align:baseline;font-size:75%;line-height:0}sup{top:-0.5em}sub{bottom:-0.25em}img{border:0}amp-img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace, monospace;font-size:1em}button,input,optgroup,select,textarea{margin:0;color:inherit;font:inherit}button{overflow:visible}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{cursor:pointer;-webkit-appearance:button}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}input{line-height:normal}input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}input[type="number"]::-webkit-inner-spin-button,input[type="number"]::-webkit-outer-spin-button{height:auto}input[type="search"]{-webkit-appearance:textfield}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}fieldset{margin:0 2px;padding:0.35em 0.625em 0.75em;border:1px solid #c0c0c0}legend{padding:0;border:0}textarea{overflow:auto}optgroup{font-weight:bold}table{border-spacing:0;border-collapse:collapse}td,th{padding:0}html{max-height:100%;height:100%;font-size:62.5%;-webkit-tap-highlight-color:rgba(0, 0, 0, 0)}body{max-height:100%;height:100%;color:#3a4145;background:#f4f8fb;letter-spacing:0.01rem;font-family:"Merriweather", serif;font-size:1.8rem;line-height:1.75em;text-rendering:geometricPrecision;-webkit-font-feature-settings:"kern" 1;-moz-font-feature-settings:"kern" 1;-o-font-feature-settings:"kern" 1}::-moz-selection{background:#d6edff}::selection{background:#d6edff}h1,h2,h3,h4,h5,h6{margin:0 0 0.3em 0;color:#2e2e2e;font-family:"Open Sans", sans-serif;line-height:1.15em;text-rendering:geometricPrecision;-webkit-font-feature-settings:"dlig" 1, "liga" 1, "lnum" 1, "kern" 1;-moz-font-feature-settings:"dlig" 1, "liga" 1, "lnum" 1, "kern" 1;-o-font-feature-settings:"dlig" 1, "liga" 1, "lnum" 1, "kern" 1}h1{text-indent:-2px;letter-spacing:-1px;font-size:2.6rem}h2{letter-spacing:0;font-size:2.4rem}h3{letter-spacing:-0.6px;font-size:2.1rem}h4{font-size:1.9rem}h5{font-size:1.8rem}h6{font-size:1.8rem}a{color:#4a4a4a}a:hover{color:#111}p,ul,ol,dl{margin:0 0 2.5rem 0;font-size:1.5rem;text-rendering:geometricPrecision;-webkit-font-feature-settings:"liga" 1, "onum" 1, "kern" 1;-moz-font-feature-settings:"liga" 1, "onum" 1, "kern" 1;-o-font-feature-settings:"liga" 1, "onum" 1, "kern" 1}ol,ul{padding-left:2em}ol ol,ul ul,ul ol,ol ul{margin:0 0 0.4em 0;padding-left:2em}dl dt{float:left;clear:left;overflow:hidden;margin-bottom:1em;width:180px;text-align:right;text-overflow:ellipsis;white-space:nowrap;font-weight:700}dl dd{margin-bottom:1em;margin-left:200px}li{margin:0.4em 0}li li{margin:0}hr{display:block;margin:1.75em 0;padding:0;height:1px;border:0;border-top:#efefef 1px solid}blockquote{box-sizing:border-box;margin:1.75em 0 1.75em 0;padding:0 0 0 1.75em;border-left:#4a4a4a 0.4em solid;-moz-box-sizing:border-box}blockquote p{margin:0.8em 0;font-style:italic}blockquote small{display:inline-block;margin:0.8em 0 0.8em 1.5em;color:#ccc;font-size:0.9em}blockquote small:before{content:"\2014 \00A0"}blockquote cite{font-weight:700}blockquote cite a{font-weight:normal}mark{background-color:#fdffb6}code,tt{padding:1px 3px;border:#e3edf3 1px solid;background:#f7fafb;border-radius:2px;white-space:pre-wrap;font-family:Inconsolata, monospace, sans-serif;font-size:0.85em;font-feature-settings:"liga" 0;-webkit-font-feature-settings:"liga" 0;-moz-font-feature-settings:"liga" 0}pre{overflow:auto;box-sizing:border-box;margin:0 0 1.75em 0;padding:10px;width:100%;border:#e3edf3 1px solid;background:#f7fafb;border-radius:3px;white-space:pre;font-family:Inconsolata, monospace, sans-serif;font-size:0.9em;-moz-box-sizing:border-box}pre code,pre tt{padding:0;border:none;background:transparent;white-space:pre-wrap;font-size:inherit}kbd{display:inline-block;margin-bottom:0.4em;padding:1px 8px;border:#ccc 1px solid;background:#f4f4f4;border-radius:4px;box-shadow:0 1px 0 rgba(0, 0, 0, 0.2), 0 1px 0 0 #fff inset;color:#666;text-shadow:#fff 0 1px 0;font-size:0.9em;font-weight:700}table{box-sizing:border-box;margin:1.75em 0;max-width:100%;width:100%;background-color:transparent;-moz-box-sizing:border-box}table th,table td{padding:8px;border-top:#efefef 1px solid;vertical-align:top;text-align:left;line-height:20px}table th{color:#000}table caption + thead tr:first-child th,table caption + thead tr:first-child td,table colgroup + thead tr:first-child th,table colgroup + thead tr:first-child td,table thead:first-child tr:first-child th,table thead:first-child tr:first-child td{border-top:0}table tbody + tbody{border-top:#efefef 2px solid}table table table{background-color:#fff}table tbody > tr:nth-child(odd) > td,table tbody > tr:nth-child(odd) > th{background-color:#f6f6f6}table.plain tbody > tr:nth-child(odd) > td,table.plain tbody > tr:nth-child(odd) > th{background:transparent}iframe,amp-iframe,.fluid-width-video-wrapper{display:block;margin:1.75em 0}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper amp-iframe{margin:0}textarea,select,input{margin:0 0 5px 0;padding:6px 9px;width:260px;outline:0;border:#e7eef2 1px solid;background:#fff;border-radius:4px;box-shadow:none;font-family:"Open Sans", sans-serif;font-size:1.6rem;line-height:1.4em;font-weight:100;-webkit-appearance:none}textarea{min-width:250px;min-height:80px;max-width:340px;width:100%;height:auto}input[type="text"]:focus,input[type="email"]:focus,input[type="search"]:focus,input[type="tel"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="number"]:focus,input[type="date"]:focus,input[type="month"]:focus,input[type="week"]:focus,input[type="time"]:focus,input[type="datetime"]:focus,input[type="datetime-local"]:focus,textarea:focus{outline:none;outline-width:0;border:#bbc7cc 1px solid;background:#fff}select{width:270px;height:30px;line-height:30px}.clearfix:before,.clearfix:after{content:" ";display:table}.clearfix:after{clear:both}.clearfix{zoom:1}.main-header{position:relative;display:table;overflow:hidden;box-sizing:border-box;width:100%;height:50px;background:#5ba4e5 no-repeat center center;background-size:cover;text-align:left;-webkit-box-sizing:border-box;-moz-box-sizing:border-box}.content{background:#fff;padding-top:15px}.blog-title,.content{margin:auto;max-width:600px}.blog-title a{display:block;padding-right:16px;padding-left:16px;height:50px;color:#fff;text-decoration:none;font-family:"Open Sans", sans-serif;font-size:16px;line-height:50px;font-weight:600}.post{position:relative;margin-top:0;margin-right:16px;margin-left:16px;padding-bottom:0;max-width:100%;border-bottom:#ebf2f6 1px solid;word-wrap:break-word;font-size:0.95em;line-height:1.65em}.post-header{margin-bottom:1rem}.post-title{margin-bottom:0}.post-title a{text-decoration:none}.post-meta{display:block;margin:3px 0 0 0;color:#9eabb3;font-family:"Open Sans", sans-serif;font-size:1.3rem;line-height:2.2rem}.post-meta a{color:#9eabb3;text-decoration:none}.post-meta a:hover{text-decoration:underline}.post-meta .author{margin:0;font-size:1.3rem;line-height:1.3em}.post-date{display:inline-block;text-transform:uppercase;white-space:nowrap;font-size:1.2rem;line-height:1.2em}.post-image{margin:0;padding-top:3rem;padding-bottom:30px;border-top:1px #E8E8E8 solid}.post-content amp-img,.post-content amp-anim{position:relative;left:50%;display:block;padding:0;min-width:0;max-width:112%;width:calc(100% + 32px);height:auto;transform:translateX(-50%);-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%)}.footnotes{font-size:1.3rem;line-height:1.6em;font-style:italic}.footnotes li{margin:0.6rem 0}.footnotes p{margin:0}.footnotes p a:last-child{text-decoration:none}.site-footer{position:relative;margin:0 auto 20px auto;padding:1rem 15px;max-width:600px;color:rgba(0,0,0,0.5);font-family:"Open Sans", sans-serif;font-size:1.1rem;line-height:1.75em}.site-footer a{color:rgba(0,0,0,0.5);text-decoration:none;font-weight:bold}.site-footer a:hover{border-bottom:#bbc7cc 1px solid}.poweredby{display:block;float:right;width:45%;text-align:right}.copyright{display:block;float:left;width:45%}</style>

    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>

    

</head>

<body class="amp-template">
    <header class="main-header">
        <nav class="blog-title">
            <a href="../../">Coding Ricky</a>
        </nav>
    </header>

    <main class="content" role="main">
        <article class="post">

            <header class="post-header">
                <h1 class="post-title">Integrating Cucumber and Play</h1>
                <section class="post-meta">
                    <p class="author">by <a href="../../author/ricky/">Ricky Yim</a></p>
                    <time class="post-date" datetime="2013-10-13">2013-10-13</time>
                </section>
            </header>
            <section class="post-content">

                <div class="kg-card-markdown"><p>The default application generated by <a href="http://www.playframework.com">Play</a> has examples of unit and integration tests, however it does not demonstrate how to integrate in any Behaviour Driven Development (BDD) frameworks. The value of a BDD framework like <a href="http://cukes.info">Cucumber</a> is extremely high when attempting to achieve strong collaboration between various stakeholders like Developers and Business Analysts. This post will show you how to get up and running with Cucumber and Play. The example uses Play 2.2.0 and Java.</p>
<ol>
<li>
<p> Assuming you have already setup a vanilla Play application already, the first thing you need to do is add the dependencies for Cucumber. Go to your <b>build.sbt</b> file and add in the dependencies for Cucumber. In this post, we will be using <a href="https://github.com/cucumber/cucumber-jvm">cucumber-jvm</a>, along with the <b>cucumber-junit</b> launcher. </p>
<pre class="prettyprint linenums">
name := "sample-with-cucumber"

version := "1.0-SNAPSHOT"

libraryDependencies ++= Seq(
  javaJdbc,
  javaEbean,
  cache
  "info.cukes" % "cucumber-java" % "1.1.5" % "test",
  "info.cukes" % "cucumber-junit" % "1.1.5" % "test"
 )     

play.Project.playJavaSettings

</pre>
</li>
<li>
<p>Let's create a directory to contain our feature files. I generally put my features in a <b>features</b> directory in the root of my application.</p>
<pre class="prettyprint linenums">
$ mkdir features
</pre>
</li>
<li>
<p>For this directory to be picked up, we need to add it into the classpath when running tests. This is a change we need to make to the <b>build.sbt</b> file.
</p><pre class="prettyprint linenums">
name := "sample-with-cucumber"

version := "1.0-SNAPSHOT"

libraryDependencies ++= Seq(
  javaJdbc,
  javaEbean,
  cache
  "info.cukes" % "cucumber-java" % "1.1.5" % "test",
  "info.cukes" % "cucumber-junit" % "1.1.5" % "test"
 )     

play.Project.playJavaSettings

unmanagedResourceDirectories in Test 
</pre></li>
<li> <p>To keep everything simple, let's create a very basic feature file. All this will do is go to the landing page and assert the title of the page is equal to the text "Cucumber".</p>
<p>Create a file <b>features/example.feature</b> containing the following contents.</p>
<pre class="prettyprint linenums">
Feature: Testing Cucumber Integration

  Scenario: Cucumber Integration
    Given I have setup Play
    When I go to the landing page
    Then the title should be "Cucumber"

</pre>
</li>
<li>
<p>To get this running, we need a class that is annotated with the Cucumber JUnit runner annotation. So create a class called <b>test/RunCucumber.java</b> with the following contents. The "pretty" flag is optional, but I much prefer that output.  </p>
<pre class="prettyprint linenums">
import cucumber.api.junit.Cucumber;
import org.junit.runner.RunWith;

@RunWith(Cucumber.class)
@Cucumber.Options(format = {"pretty"})
public class RunCucumber {
}
</pre>  
</li>
<li>
<p>Now let's checkpoint what we have done so far. If everything is working, we should be able to run Cucumber and it should complain that we are missing step definitions.</p>
<pre class="prettyprint">
$ play test
</pre> 
<pre class="prettyprint">
...
You can implement missing steps with the snippets below:

@Given("^I have setup Play__aSyNcId_&lt;_awhU_DOG__quot;)
public void I_have_setup_Play() throws Throwable {
    // Express the Regexp above with the code you wish you had
    throw new PendingException();
}

@When("^I go to the landing page__aSyNcId_&lt;_awhU_DOG__quot;)
public void I_go_to_the_landing_page() throws Throwable {
    // Express the Regexp above with the code you wish you had
    throw new PendingException();
}

@Then("^the title should be \"([^\"]*)\"__aSyNcId_&lt;_awhU_DOG__quot;)
public void the_title_should_be(String arg1) throws Throwable {
    // Express the Regexp above with the code you wish you had
    throw new PendingException();
}

</pre>
</li>
<li>
<p>To get the scenario to pass, we need to first put a startup hook in place to initialize our server and test browser. Cucumber does provide a <b>@Before</b> hook but this is executed before each and every scenario. We only want to initialize our server and browser once before the very first scenario, so we need to add some state to manage this ourselves.</p>
<p>Create a <b>test/GlobalHooks.java</b> class and add the following contents.</p>
<pre class="prettyprint linenums">
import cucumber.api.java.Before;
import play.test.TestBrowser;
import play.test.TestServer;
import static play.test.Helpers.*;

public class GlobalHooks {
    public static int PORT = 3333;
    public static TestBrowser TEST_BROWSER;
    private static TestServer TEST_SERVER;
    private static boolean initialised = false;

    @Before
    public void before() {
        if (!initialised) {
            TEST_SERVER = testServer(PORT, fakeApplication(inMemoryDatabase()));
            TEST_BROWSER = testBrowser(HTMLUNIT, PORT);
            start(TEST_SERVER);
            initialised = true;
        }
    }

}
</pre>  
<p>There's also no shutdown hook in Cucumber, so we need to add the clean up of the server and browser into the JVM shutdown hook. </p><p>
</p><pre class="prettyprint linenums">
import cucumber.api.java.Before;
import play.test.TestBrowser;
import play.test.TestServer;
import static play.test.Helpers.*;

public class GlobalHooks {
    public static int PORT = 3333;
    public static TestBrowser TEST_BROWSER;
    private static TestServer TEST_SERVER;
    private static boolean initialised = false;

    @Before
    public void before() {
        if (!initialised) {
            TEST_SERVER = testServer(PORT, fakeApplication(inMemoryDatabase()));
            TEST_BROWSER = testBrowser(HTMLUNIT, PORT);
            start(TEST_SERVER);
            initialised = true;
            Runtime.getRuntime().addShutdownHook(new Thread() {
                @Override
                public void run() {
                    TEST_BROWSER.quit();
                    TEST_SERVER.stop();
                }
            });
        }
    }
}
</pre>  
</li>
<li>
<p>Now we should be able to implement our steps. So create a <b>test/Steps.java</b> file. For the moment, we will just statically reference our <b>TEST_BROWSER</b>. There is a better way to inject this dependency in, which I will cover later. </p>
<pre class="prettyprint linenums">
import cucumber.api.java.en.Given;
import cucumber.api.java.en.Then;
import cucumber.api.java.en.When;
import static org.fest.assertions.Assertions.assertThat;

public class Steps {
    @Given("^I have setup Play__aSyNcId_&lt;_awhU_DOG__quot;)
    public void I_have_setup_Play() throws Throwable {
    }

    @When("^I go to the landing page__aSyNcId_&lt;_awhU_DOG__quot;)
    public void I_go_to_the_landing_page() throws Throwable {
        GlobalHooks.TEST_BROWSER.goTo("http://localhost:" + GlobalHooks.PORT);
    }

    @Then("^the title should be \"([^\"]*)\"__aSyNcId_&lt;_awhU_DOG__quot;)
    public void the_title_should_be(String title) throws Throwable {
        assertThat(GlobalHooks.TEST_BROWSER.title()).isEqualTo(title);
    }
}
</pre>
</li>
<li><p>We should now be in a position to rerun this. The steps should be found however the title of the page will not be "Cucumber" resulting in a failure. </p>
<pre class="prettyprint">
$ play test
</pre>
<pre class="prettyprint">
...
0m[error] Test Scenario: Cucumber Integration failed: expected: but was:
...
</pre>
</li>
<li>
<p>Let's correct the title of the page and rerun the test.</p>
<p>Navigate to <b>app/views/index.scala.html</b>. Update the title of the page to be "Cucumber"</p>
<pre class="prettyprint linenums">
@(message: String)

@main("Cucumber") {
    @play20.welcome(message, style = "Java")
}
</pre>
</li>
<li>
<p>Rerun the test and it should succeed.</p>
<pre class="prettyprint">
1 Scenarios (1 passed)
3 Steps (3 passed)
0m3.544s
</pre>
</li>
<li><p>The last series of changes will be around integrating with <a href="http://code.google.com/p/google-guice/">Guice</a> so we can inject our dependencies into the Steps. This will remove the need to directly reference the test browser.</p>
<p>Go back into the <b>build.sbt</b> file and add the dependencies for <b>guice</b> as well as <b>cucumber-guice</b>, which provides the binding for guice into cucumber.</p>
<pre class="prettyprint linenums">
name := "sample-with-cucumber"

version := "1.0-SNAPSHOT"

libraryDependencies ++= Seq(
  javaJdbc,
  javaEbean,
  cache,
  "com.google.inject" % "guice" % "3.0" % "test",
  "info.cukes" % "cucumber-guice" % "1.1.5" % "test",
  "info.cukes" % "cucumber-java" % "1.1.5" % "test",
  "info.cukes" % "cucumber-junit" % "1.1.5" % "test"
 )     

play.Project.playJavaSettings

unmanagedResourceDirectories in Test  
</pre></li>
<li>
<p>Define a <b>test/CucumberModule.java</b> class which will setup our bindings.</p>
<pre class="prettyprint linenums">
import com.google.inject.AbstractModule;
import com.google.inject.name.Names;
import play.test.TestBrowser;
import play.test.TestServer;
import static play.test.Helpers.*;

public class CucumberModule extends AbstractModule {

    private static int PORT = 3333;
    private TestServer testServer = testServer(PORT, fakeApplication(inMemoryDatabase()));
    private TestBrowser testBrowser = testBrowser(HTMLUNIT, PORT);

    @Override
    protected void configure() {
        bind(TestBrowser.class).toInstance(testBrowser);
        bind(TestServer.class).toInstance(testServer);
        bind(Integer.class).annotatedWith(Names.named("PORT")).toInstance(PORT);
    }
}

</pre>
<p>Now change <b>test/GlobalHooks.java</b> to be dependency injected.</p>
<pre class="prettyprint linenums">
import com.google.inject.Inject;
import cucumber.api.java.Before;
import play.test.TestBrowser;
import play.test.TestServer;
import static play.test.Helpers.*;

public class GlobalHooks {
    @Inject
    private TestBrowser testBrowser;
    @Inject
    private TestServer testServer;
    private static boolean initialised = false;

    @Before
    public void before() {
        if (!initialised) {
            start(testServer);
            initialised = true;
            Runtime.getRuntime().addShutdownHook(new Thread() {
                @Override
                public void run() {
                    testBrowser.quit();
                    testServer.stop();
                }
            });
        }
    }
}
</pre>
<p>Change <b>test/Steps.java</b> to be dependency injected.</p>
<pre class="prettyprint linenums">
import com.google.inject.Inject;
import com.google.inject.name.Named;
import cucumber.api.java.en.Given;
import cucumber.api.java.en.Then;
import cucumber.api.java.en.When;
import play.test.TestBrowser;
import static org.fest.assertions.Assertions.assertThat;

public class Steps {
    @Inject
    private TestBrowser testBrowser;

    @Inject
    @Named("PORT")
    private Integer port;

    @Given("^I have setup Play__aSyNcId_&lt;_awhU_DOG__quot;)
    public void I_have_setup_Play() throws Throwable {
    }

    @When("^I go to the landing page__aSyNcId_&lt;_awhU_DOG__quot;)
    public void I_go_to_the_landing_page() throws Throwable {
        testBrowser.goTo("http://localhost:" + port);
    }

    @Then("^the title should be \"([^\"]*)\"__aSyNcId_&lt;_awhU_DOG__quot;)
    public void the_title_should_be(String title) throws Throwable {
        assertThat(testBrowser.title()).isEqualTo(title);
    }
}
</pre>
</li>
<li><p>Lastly add a <b>features.cucumber-guice.properties</b> file to refer to our module. So this file should have the following contents.</p>
<pre class="prettyprint linenums">
guiceModule=CucumberModule
</pre>
</li>
<li><p>Now if we rerun everything, then the test should still pass which will prove that everything has been setup correctly.</p>
<pre class="prettyprint linenums">
$ play test
</pre>
<pre class="prettyprint">
Feature: Testing Cucumber Integration

  Scenario: Cucumber Integration        # example.feature:3
    Given I have setup Play             # Steps.I_have_setup_Play()
    When I go to the landing page       # Steps.I_go_to_the_landing_page()
    Then the title should be "Cucumber" # Steps.the_title_should_be(String)

1 Scenarios (1 passed)
3 Steps (3 passed)
0m2.092s
</pre>
</li>
</ol>
<p>So this posting has taken you through the steps required to integrate Cucumber and Play. It also has shown you how to integrate Guice into your Cucumber Steps to keep your code cleaner. An example of this sample application can be found <a href="https://github.com/codingricky/sample-play-with-cucumber">here</a>.</p></div>

            </section>

        </article>
    </main>
    <footer class="site-footer clearfix">
        <section class="copyright"><a href="../../">Coding Ricky</a> Â© 2018</section>
        <section class="poweredby">Proudly published with <a href="https://ghost.org">Ghost</a></section>
    </footer>
</body>
